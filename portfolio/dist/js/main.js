(()=>{"use strict";const e=[{id:1,title:"Нет пепла",img:"1.png",right:!0},{id:2,title:"Есть дым и пепел",img:"2.png",right:!1},{id:3,title:"Меньше едкого запаха,чем при курении сигарет",img:"3.png",right:!0},{id:4,title:"Нет нагревания",img:"4.png",right:!1},{id:5,title:"Настоящий вкус табака",img:"5.png",right:!0},{id:6,title:"Нет сигаретного дыма",img:"6.png",right:!0}],t=["Не совсем так","Кажется, где-то ошибка","Чего-то не хватает"],i=document.querySelector(".btn_close");if("undefined"!=typeof window){const e=window.Telegram.WebApp;e.expand(),i.addEventListener("click",(()=>{e.close(),localStorage.clear()}))}let n="https://iqosmeetingbot-test.cleverbots.ru"==window.location.host?" https://iqosmeetingbot.cleverbots.ru/":"https://iqosmeetingbot-test.cleverbots.ru/";n+="api/actions/q_club/webbot";const s=document.querySelector(".game_title"),a=document.querySelector(".game_wrapper"),l=document.querySelector(".container"),o=document.querySelector(".btn_again"),d=document.querySelector(".btn_start"),c=document.querySelector(".game_final-frame");let r,m;function u(e){if(e.classList.contains("filled")){const t=e.dataset.id,i=document.querySelector(`.game_item[data-id="${t}"]`);e.src="./images/7.png",e.classList.remove("filled"),e.dataset.id="",i.classList.remove("disabled")}}function _(e){if(e.classList.contains("disabled"))return;const t=document.querySelector(".puzzle_container img:not(.filled)");if(t){const i=e.querySelector("img");t.src=i.src,t.dataset.id=e.dataset.id,t.classList.add("filled"),e.classList.add("disabled")}}function g(e){var t,i,n=window.location.search.substring(1).split("&");for(i=0;i<n.length;i++)if((t=n[i].split("="))[0]===e)return void 0===t[1]||decodeURIComponent(t[1]);return!1}document.querySelector(".footer"),m=g("user_id")?g("user_id"):"0",console.log(m),window.onload=()=>{if(r=document.querySelector(".game_validate"),!r)return void console.error("Элемент с классом 'game_validate' не найден на странице.");const g=document.createElement("button");g.classList.add("btn_validate","btn_game"),g.textContent="Готово",g.addEventListener("click",(()=>{const d=document.querySelectorAll(".puzzle_field"),u=Array.from(d).every((t=>{const i=t.dataset.id,n=e.find((e=>e.id===Number(i)));return t.src.includes(n.img)===n.right})),_=function(){const e=Math.floor(Math.random()*t.length);return t[e]}();u?(function(e,t,i,n,s,a,l,o,d){e.classList.add("hide"),t.classList.add("hide"),o.classList.remove("hide"),i.style.display="none",n.style.display="block",a.classList.remove("hide"),l.style.display="none",s.innerHTML="<b>Прекрасно! Вы отлично справились!</b><br/>Главное преимущество — отсутствие горения. <br/>А значит",s.append()}(g,o,a,l,s,c,r,i),async function(e){const t={user_id:m,event:"passed_all_scenario"};console.log(t);try{const e=await fetch(n,{method:"POST",headers:{"Content-Type":"text/plain"},body:JSON.stringify(t)});if(!e.ok){const t=await e.text();return void console.error("Ошибка при отправке запроса:",t)}const i=await e.json();console.log(i)}catch(e){console.error("Ошибка при отправке запроса:",e)}}()):function(e,t,i,n,s,a,l){a.style.display="block",e.classList.add("hide"),t.classList.remove("hide"),i.style.display="none",n.style.display="none",s.style.display="none";const o=document.createElement("div");o.classList.add("quize__x__item","quize__x__item--status"),o.innerHTML=`\n        <div class='quize__x__item--status__info'>\n          <div class='quize__x__item--status__info__inner'>\n            <div class='quize__x__item--status__icon'>\n              <img src='images/wrong.svg'>\n            </div>\n            <div class='quize__x__item--status__title'>${l}</div>\n          </div>\n        </div>\n      `,a.insertBefore(o,s.nextSibling)}(g,o,r,a,s,l,_)})),o.addEventListener("click",(()=>{location.reload()})),d.addEventListener("click",(()=>{s.textContent=null,a.classList.remove("hide"),r.classList.remove("hide"),d.classList.add("hide"),l.style.display="block"})),r.appendChild(g),function(){const e=document.createElement("div");e.classList.add("puzzle_container");const t=document.createElement("div");t.classList.add("puzzle_frame");for(let i=1;i<=4;i++){const n=document.createElement("img");n.classList.add("puzzle_field",`puzzle_field_${i}`),n.src="./images/7.png",n.alt="puzzle_wrapper",e.appendChild(t),t.appendChild(n),n.addEventListener("click",(()=>{u(n)}))}r.appendChild(e)}(),function(e,t,i){e.forEach(((e,n)=>{const s=document.createElement("div");s.classList.add("game_item"),s.dataset.id=e.id,s.innerHTML=`\n        <p class="item_title">${e.title}</p>\n        <img src="./images/${e.img}" alt="pazzle" class="item_image item_image_${n}" />\n      `,s.addEventListener("click",(()=>{i(s)})),t.appendChild(s)}))}(e,a,_),function(e){e.innerHTML='<img src="./images/final.png" alt="finalFrame" class="game_final-img" />\n  <span class="game_final-text game_final-text_1"\n    >Нет сигаретного дыма</span\n  >\n  <span class="game_final-text game_final-text_2"\n    >Настоящий вкус табака</span\n  >\n  <span class="game_final-text game_final-text_3">Нет пепла</span>\n  <span class="game_final-text game_final-text_4"\n    >Меньше едкого запаха, чем при курении сигарет</span\n  >'}(c)}})();